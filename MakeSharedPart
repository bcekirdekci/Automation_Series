# Python Script, API Version = V18

def main():
    
    tag = "_sh"
    part = GetRootPart()

    # Change Object Visibility
    allBodies = part.GetAllBodies()



    HideBodies(allBodies)

    components = part.GetAllComponents()
    
    compNum = components.Count
    counter = 1

    # Loop through the components
    for comp in components:
        
        print str(counter) + " / " + str(compNum) +" done"
        counter += 1
        
        compName = comp.GetName()

        if tag in compName:
            bodiesInPart = comp.GetAllBodies()
            
            ShowBodies(bodiesInPart)        

            # Share Topology
            options = ShareTopologyOptions()
            options.Tolerance = MM(0.2)
            result = ShareTopology.FindAndFix(options)
            # EndBlock
            
            HideBodies(bodiesInPart)


def HideBodies(BodyArray):

    selection = Selection.Create(BodyArray)
    visibility = VisibilityType.Hide
    inSelectedView = False
    faceLevel = False
    ViewHelper.SetObjectVisibility(selection, visibility, inSelectedView, faceLevel)
    # EndBlock


def ShowBodies(BodyArray):

    selection = Selection.Create(BodyArray)
    visibility = VisibilityType.Show
    inSelectedView = False
    faceLevel = False
    ViewHelper.SetObjectVisibility(selection, visibility, inSelectedView, faceLevel)
    # EndBlock
    
main()
